---
import { getWebsiteData } from '../services/cms';
import { getDefaultLanguage } from '../utils/language';

const websiteData = await getWebsiteData();

if (websiteData) {
  const supportedLocales = websiteData.supportedLocales.length > 0
    ? websiteData.supportedLocales
    : [websiteData.defaultLocale];

  const defaultLang = getDefaultLanguage(supportedLocales, websiteData.defaultLocale);
  return Astro.redirect(`/${defaultLang}`);
}

// If no website data, redirect to English as fallback
return Astro.redirect('/en');
---
